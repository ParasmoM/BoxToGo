{% extends 'admin/dashboard.html.twig' %}

{% block javascripts %}
<script src="{{ asset('js/admin/analytics.js') }}" defer></script>
{% endblock %}

{% set data = pagination[1] %}

{% block search %}
    {{ form_start(form, {'attr': {'class': 'admin-features-search' }}) }}
    <div class="admin-features-search__item">
        {{ form_label(form.reference) }}
        <p>
            <button type="submit"><img src="{{ asset('images/icones/global/Loop.svg') }}" alt=""></button>
            {{ form_widget(form.reference) }}
        </p>
    </div>

    {{ form_row(form.status) }}

    {{ form_row(form.category) }}

    <div class="admin-features-search__item">
        {{ form_label(form.customer) }}
        <p>
            <button type="submit"><img src="{{ asset('images/icones/global/Loop.svg') }}" alt=""></button>
            {{ form_widget(form.customer) }}
        </p>
    </div>
    {{ form_end(form) }}  
{% endblock search %}

{% block header %}
    <div><span>REFERENCE</span></div>
    <div>STATUS</div>
    <div>CATEGORY</div>
    <div>CUSTOMER</div>
    <div><span>PROFILE</span></div>
{% endblock header %}

{% block main %}
    {% for element in data %}
    
        <div class="dashboard-admin__items">
            <div class="dashboard-admin__item-data img-space">
                <div>
                    {% include "components/_spaceImage.html.twig" with {'element': element} %}
                </div>
                <p>
                    {{ element.reference }}
                    {% set currentDate = "now"|date("U") %}
                    {% set elementDate = element.createAt|date("U") %}
                    {% set difference = (currentDate - elementDate) / 86400 %} <!-- Nombre de secondes dans une journÃ©e -->
                    
                    {% if difference < 30 %}
                        <span class="new">New</span>
                    {% endif %}
                </p>
            </div>
            <div class="dashboard-admin__item-data">
                <p>{{ element.ownedByUser.status }}</p>
            </div>
            <div class="dashboard-admin__item-data">
                <p>{{ element.type }}</p>
            </div>
            <div class="dashboard-admin__item-data img-profile">
                <div>
                    {% include "components/_avatar.html.twig" with {'instance': element.ownedByUser} %}
                </div>
            </div>
            <div class="dashboard-admin__item-data">
                <a href="{{ path('public_property_details', {id: element.id}) }}">View</a>
            </div>
        </div>
        {% endfor %}
        {# {{ dump(route) }} #}
{% endblock main %}

